# emo.Runtime #

emo.Runtime class represents basic functions for emo-framework runtime that contains import, log and so on.

## import ##

Runtime#import imports and compiles the Squirrel scripts from the asset. Any files from asset can be imported using this function on demand at runtime. This function is useful for loading new stage or levels dynamically at runtime. **From emo version 0.1.5**, import() accepts precompiled Squirrel bytecode binary files. Squirrel's precompiled bytecode binary files can be generated by using writeclosuretofile(destpath, clouse) function in the Squirrel's standard input/output library. The bytecode format is environment-dependent: (little-endian, 32bit, no UTF for Android & iPhone).

```
local runtime = emo.Runtime();
runtime.import("stage2.nut");
// for short, you can write import statement like this.
// emo.Runtime.import("stage2.nut");
```

## log ##

Runtime#log is useful for print debug message into the log console. Loggin message can be seen at logcat(Android) or console(iOS). Runtime#log needs log level parameter and message string.

```
local runtime = emo.Runtime();
runtime.log(LOG_INFO, "info message");
runtime.log(LOG_ERROR, "error message");
runtime.log(LOG_WARN, "warn message");
```

## info ##

Runtime#info is useful for print debug information message into the log console. Logging message can be seen at logcat(Android) or console(iOS).

```
local runtime = emo.Runtime();
runtime.info("info message");
```

## error ##

Runtime#info is useful for print error message into the log console. Logging message can be seen at logcat(Android) or console(iOS).

```
local runtime = emo.Runtime();
runtime.error("error message");
```

## warn ##

Runtime#info is useful for print warning message into the log console. Logging message can be seen at logcat(Android) or console(iOS).

```
local runtime = emo.Runtime();
runtime.warn("warn message");
```

## setLogLevel ##

Runtime#setLogLevel sets the current log level. Log level is used to suppress unnecessary log message sent from the application. If the log level equals 'LOG\_INFO', all messages are logged, if the log level equals LOG\_WARN 'warn' and 'error' messages are logged. If the log level equals LOG\_ERROR only the 'error' messages are logged. The default log level is 'LOG\_INFO'.

```
local runtime = emo.Runtime();
// suppress the 'info' message'
runtime.setLogLevel(LOG_WARN);

// suppress the 'info' and 'warn' message
//runtime.setLogLevel(LOG_ERROR);
```

## setOptions ##

Runtime#setOptions sets options for framework. Available options are listed below.

```
local runtime = emo.Runtime();

// set oriantation option
runtime.setOptions(OPT_ORIENTATION_PORTRAIT);
```

### OPT\_ORIENTATION\_PORTRAIT ###

Set the current orientation to portrait. This option tells framework the current orientation is portrait. To keep the current orientation additional setting is required. See [Tips](Tips.md) for details.

### OPT\_ORIENTATION\_LANDSCAPE ###
### OPT\_ORIENTATION\_LANDSCAPE\_LEFT (**iOS Only**) ###
### OPT\_ORIENTATION\_LANDSCAPE\_RIGHT (**iOS Only**) ###

Set the current orientation to landscape. This option tells framework the current orientation is landscape. OPT\_ORIENTATION\_LANDSCAPE\_RIGHT and OPT\_ORIENTATION\_LANDSCAPE\_RIGHT are only supported by iOS. RIGHT and LEFT options are ignored by Android and OPT\_ORIENTATION\_LANDSCAPE is used instead. To keep the current orientation additional setting is required. See [Tips](Tips.md) for details.

### os ###

Runtime#os returns OS type that emo-framework is running on. OS\_ANDROID and OS\_IOS constant variable can be used to check the os name.

```
local runtime = emo.Runtime();
local os = runtime.os();
if (os == OS_ANDROID) {
  print("Android");
} else if (os == OS_IOS) {
  print("iOS");
}
```

## device ##

Runtime#device returns device type that emo-framework is running on. For iPhone this function returns the "hw.machine" value of sysctlbyname. For Android this function returns the value of android.os.Build.DEVICE constant;

```
local runtime = emo.Runtime();
local device = runtime.device();
// returns 'iPhone3,1' if it runs on iPhone 4
// returns 'generic' if it runs on Android Simulator
```

## isSimulator ##

Runtime#isSimulator returns if the emo-framework runs on the simulator. This function is useful for developing and debugging.

```
local runtime = emo.Runtime();
if (runtime.isSimulator()) {
    print("this program runs on the simulator");
} else {
    print("this program runs on the actual device");
}
```

## finish ##

Runtime#finish finishes the current activity. **Runtime#finish works only on the Android platform**. Nothing is happened if finish() is called from iOS because the 'Home' button is the only way to finish the application.

```
local runtime = emo.Runtime();
runtime.finish(); // finishes the current activity
```

emo.Event represents interfaces to handle events

## clearTextureCache ##

Clears all texture cache in the game engine. The engine caches all textures when loading sprites and clearTextureCache() clears all texture cache from the memory. Use this function to avoid low memory warnings.

```
emo.Runtime.clearTextureCache();
```

## compilebuffer ##

Compiles a squirrel program with given string. **Note:** compilebuffer is disabled by default on iOS. Remove EMO\_WITH\_SANDBOX constant in emo/Constants.h to enable this function.

```
local script = "function run() { local index=0; print(index); }";
emo.Runtime.compilebuffer(script);
run(); // it prints '0' 
```

## compile ##

Compiles a squirrel program with given file name. There are three ways to read scripts from the directory: TYPE\_ASSET, TYPE\_DOCUMENT and with absolute path to the script file. **Note:** compilebuffer is disabled by default on iOS. Remove EMO\_WITH\_SANDBOX constant in emo/Constants.h to enable this function.

```
// compiles script from resource (same as emo.Runtime.import)
emo.Runtime.compile("user_script.nut", TYPE_ASSET);

// compiles script from user document directory.
emo.Runtime.compile("user_script.nut", TYPE_DOCUMENT);

// compiles script specified by full path (not recommended)
emo.Runtime.compile("/Library/user_script.nut"); 
```

The user document directory is: NSDocumentDirectory on iOS.

```
NSString* docDir = [NSSearchPathForDirectoriesInDomains(
      NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
```

On Android, the user document directory equas context.getFilesDir().
e.g. /data/com.emo\_framework/files/user\_script.nut

## getDocumentDir ##

Returns the user document directory for the platform.

```
print(format("document directory: %s", emo.Runtime.getDocumentDir()));
```

## enableSimpleLog(enable = true) ##

**For iOS only**: Remove tag and log level strings from the logging console output. works only on iOS with emo-framework version 0.1.5 and above.

```
// prints "EmoFramework INFO log with tag and level"
print("log with tag and level");

// enable simple log output
emo.Runtime.enableSimpleLog();
// prints "log without tag and level"
print("log without tag and level");

// disable simple log output
emo.Runtime.enableSimpleLog(false);
// prints "EmoFramework INFO log with tag and level"
print("log with tag and level");

// enable simple log output
emo.Runtime.enableSimpleLog(true);
// prints "log without tag and level"
print("log without tag and level");
```

## enableSimpleLogWithLevel(enable = true) ##

**For iOS only**: Remove tag strings from the logging console output. works only on iOS with emo-framework version 0.1.5 and above.

```
// prints "EmoFramework INFO log with tag and level"
print("log with tag and level");

// enable simple log output with log level
emo.Runtime.enableSimpleLogWithLevel();
// prints "INFO log without tag"
print("log without tag");

// disable simple log output with log level
emo.Runtime.enableSimpleLogWithLevel(false);
// prints "EmoFramework INFO log with tag and level"
print("log with tag and level");

// enable simple log output with log level
emo.Runtime.enableSimpleLogWithLevel(true);
// prints "INFO log without tag"
print("log without tag");
```

## random() ##
## random(max) ##

Returns pseudorandom integer value with a positive sign, greater than or equal to 0 and less than max.

```
print(emo.Runtime.random()); // prints random integer with a positive sign

print(emo.Runtime.random(10)); // returns random integer, greater or equal to 0 and less than 10. (0 - 9)
```

## getDefaultLocale ##

Returns default locale of the device.

```
// prints en_US, ja_JP, etc.
print(emo.Runtime.getDefaultLocale());
```